<!doctype html>
<html  class="no-js" lang="">
<head>
    <meta charset="utf-8">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">


    <link rel="stylesheet" href="css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="css/style.css" rel="stylesheet" type="text/css">
    <!--<script language="JavaScript" type="text/javascript" src="myjavascript.js"></script>-->

</head>
<body>

    <!--<nav class="navbar navbar-dark bg-primary">
      <form class="form-inline">
          <a class="bottone" href="#">Button 1</a>
          <a class="bottone" href="#">Button 2</a>
          <a class="bottone" href="#">Button 3</a>
      </form>
    </nav>-->
    <header>
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExample08" aria-controls="navbarsExample08" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>

          <div class="collapse navbar-collapse justify-content-md-center" id="navbarsExample08">
            <ul class="navbar-nav">
                <li class="nav-item ">
                    <a class="nav-link" href="programmi.html">Tutti I Programmi<span class="sr-only">(current)</span></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="Indignato.html">Indignato<span class="sr-only">(current)</span></a>
                </li>
              <li class="nav-item">
                <a class="nav-link" href="Trash.html">Trash<span class="sr-only">(current)</span></a>
              </li>
              <li class="nav-item">
                <!--<a class="nav-link" href="#">Link</a>-->
                <a class="nav-link" href="Sportivo.html">Sportivo<span class="sr-only">(current)</span></a>
              </li>
              <li class="nav-item">
                <!--<a class="nav-link disabled" href="#">Disabled</a>-->
                <a class="nav-link active" href="Famiglia.html">Famiglia<span class="sr-only">(current)</span></a>
              </li>
              <li class="nav-item">
                  <a class="nav-link" href="Emittenti.html">Emittenti<span class="sr-only">(current)</span></a>
                </a>
              </li>
              <li class="nav-item">
                  <a class="nav-link" href="http://www.visualdataweb.de/webvowl/#iri=https://raw.githubusercontent.com/theo-paris/AssisTV/master/AssisTV.owl" target="_blank"><img title="Knowledge Graph" src='graph.png'width='40' height='20'><span class="sr-only">(current)</span></a>
                </a>
              </li>
            </ul>
          </div>
      </nav>
  </header>

  <div class="content">
    <div class="row">
      <div class="col-md-8 ml-auto mr-auto">
        <div class="card card-plain card-subcategories">
          <div class="card-header ">
            <h4 class="card-title text-center">AssisTV</h4>
            <h5 class="card-title text-center">Hai scelto la sezione Famiglia!</h5>
             <h6 class="card-title text-center">Siamo attenti alle censure, quindi lascia che i tuoi bambini vedano questi canali!</h6>

            </p>
            <br />
          </div>
          <div class="card-body ">

          <div style="background-color: white;">
            <table id="table" class="table table-striped" style="width:100%; margin-top:3em;">
              <tr id="head">
                <th id="ppp" cope="col" style="width:20%;">Giorno</th>
                <th scope="col" >Programma</th>
                <th scope="col" >Descrizione</th>
                <th scope="col" >Bollino</th>
                <th scope="col" >Ora</th>
                <th scope="col" >Durata</th>
                <th scope="col" >Canale</th>
              </tr>
              <tr id="consoleName">

              </tr>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

    <footer class="footer">
      <p>All Right Reserved © AssisTV 2020 - Università degli Studi di Torino</p>
    </footer>

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <script src="modernizr-3.7.1.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <script>window.jQuery || document.write('<script src="js/vendor/jquery-3.3.1.min.js"><\/script>')</script>
    <script src="plugins.js"></script>
    <!--<script src="./css/bootstrap.min.js.download"></script>-->

    <!-- Google Analytics: change UA-XXXXX-Y to be your site's ID. -->
    <script>
      window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
      ga('create', 'UA-XXXXX-Y', 'auto'); ga('set','transport','beacon'); ga('send', 'pageview')
    </script>
    <script src="https://www.google-analytics.com/analytics.js" async defer></script>
    <!-- Google Analytics: change UA-XXXXX-Y to be your site's ID. -->
    <script>
      window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
      ga('create', 'UA-XXXXX-Y', 'auto'); ga('set','transport','beacon'); ga('send', 'pageview')
    </script>
    <script src="https://www.google-analytics.com/analytics.js" async defer></script>


    <script>

    /**
     * Funzione che inzia la richiesta all'indirizzo dello SPARQL endpoint, specificato in riga 142.
     * Dopo aver specificato la query di richiesta dati, codifichiamo la richiesta in URI in formato URF-8 e effettuiamo la vera e propria richiesta ajax.
     * Dopo aver ottenuto i dati, li manipoliamo sull'html, in particolare su una tabella, i dati risultano essere ordinati in base all'orario grazie all'order by
     * Si è effettuato per via programmatica la suddivisione in giorni, che permette quindi di visualizzare per ogni giorno, dalla mattina alla sera.
     * E' stato specificato un messaggio d'errore per verificare che tutto funzionasse correttamente e per facilitare lo sviluppo.

}


     **/
      $(document).ready(function () {

        var key = "dba";
        var url = "http://localhost:8890/sparql";
        var defGIRI= "http://localhost:8890/DAV/Assistv"
        var query = "select ?p ?d ?b ?o ?m ?dr ?c ?g where {?p a AssisTV:Famiglia. ?p AssisTV:Descrizione ?d . ?p AssisTV:ha_visto_censura ?b.?p time:hour ?o.?p time:minute ?m.?p AssisTV:ha_durata ?dr. ?p AssisTV:è_trasmesso_il ?g.?p AssisTV:è_trasmesso_su ?c.} order by ?o, ?m"; //select ?p ?d ?b ?o ?m ?dr where {?p AssisTV:Descrizione ?d . ?p AssisTV:ha_visto_censura ?b.?p AssisTV:ha_ora ?o.?p AssisTV:ha_minuti ?m.?p AssisTV:ha_durata ?dr.}
        var queryUrl = encodeURI(url + "?default-graph-uri=" + defGIRI + "&query=" + query+ "&wskey="+ key + "&format=json");

        $.ajax({
          dataType: 'jsonp',
          url: queryUrl,
          method: 'GET',

          statusCode:{

          },
          success: function (dati) {

            var str = "";
            var table = $("#table");



                        //lunedi
                        if(dati.head.vars){
                          var i = 0
                          //alert("g"); ok
                          $.each(dati.results.bindings, function(index, b){

                          if(b.g.value.slice(b.g.value.search("#") +1)=="lunedi")
                          {
                            if(i==0){var row = $("<tr>").appendTo(table);
                            row.append($("<td>", {text: b.g.value.slice(b.g.value.search("#") +1)})); i=1;}
                            console.log(index);
                            console.log(b);

                            var row = $("<tr>").appendTo(table);
                            row.append($("<td>"));
                            row.append($("<td>", {text: b.p.value.slice(b.p.value.search("#") +1)}));
                            row.append($("<td>", {text: b.d.value}));
                            if(b.b.value == "http://www.semanticweb.org/teo/ontologies/2020/0/AssisTV#bollino_rosso") {row.append($("<td>" + "<img src='Bollino_rosso_TV.png'width='40' height='40'> "));}
                            if(b.b.value == "http://www.semanticweb.org/teo/ontologies/2020/0/AssisTV#bollino_giallo") {row.append($("<td>" + "<img src='Bollino_giallo_TV.png'width='40' height='40'> "));}
                            if(b.b.value == "http://www.semanticweb.org/teo/ontologies/2020/0/AssisTV#bollino_verde") {row.append($("<td>" + "<img src='bollino_verde_TV.png'width='40' height='40'> "));}
                            row.append($("<td>", {text: b.o.value+":"+b.m.value}));
                            row.append($("<td>", {text: b.dr.value}));
                            row.append($("<td>", {text: b.c.value.slice(b.c.value.search("#") +1)}));
                          }
                          });

                        }
                        //martedi
                        if(dati.head.vars){
                          var i = 0
                          //alert("g"); ok
                          $.each(dati.results.bindings, function(index, b){

                          if(b.g.value.slice(b.g.value.search("#") +1)=="martedi")
                          {
                            if(i==0){var row = $("<tr>").appendTo(table); '<br>'
                            row.append($("<td>", {text: b.g.value.slice(b.g.value.search("#") +1)})); i++;}

                            console.log(index);
                            console.log(b);

                            var row = $("<tr>").appendTo(table);
                            row.append($("<td>"));
                            row.append($("<td>", {text: b.p.value.slice(b.p.value.search("#") +1)}));
                            row.append($("<td>", {text: b.d.value}));
                            if(b.b.value == "http://www.semanticweb.org/teo/ontologies/2020/0/AssisTV#bollino_rosso") {row.append($("<td>" + "<img src='Bollino_rosso_TV.png'width='40' height='40'> "));}
                            if(b.b.value == "http://www.semanticweb.org/teo/ontologies/2020/0/AssisTV#bollino_giallo") {row.append($("<td>" + "<img src='Bollino_giallo_TV.png'width='40' height='40'> "));}
                            if(b.b.value == "http://www.semanticweb.org/teo/ontologies/2020/0/AssisTV#bollino_verde") {row.append($("<td>" + "<img src='bollino_verde_TV.png'width='40' height='40'> "));}
                            row.append($("<td>", {text: b.o.value+":"+b.m.value}));
                            row.append($("<td>", {text: b.dr.value}));
                            row.append($("<td>", {text: b.c.value.slice(b.c.value.search("#") +1)}));
                          }
                          });

                        }
                        //mercoledi
                        if(dati.head.vars){
                          var i = 0
                          //alert("g"); ok
                          $.each(dati.results.bindings, function(index, b){

                          if(b.g.value.slice(b.g.value.search("#") +1)=="mercoledi")
                          {
                            if(i==0){var row = $("<tr>").appendTo(table); '<br>'
                            row.append($("<td>", {text: b.g.value.slice(b.g.value.search("#") +1)})); i++;}

                            console.log(index);
                            console.log(b);

                            var row = $("<tr>").appendTo(table);
                            row.append($("<td>"));
                            row.append($("<td>", {text: b.p.value.slice(b.p.value.search("#") +1)}));
                            row.append($("<td>", {text: b.d.value}));
                            if(b.b.value == "http://www.semanticweb.org/teo/ontologies/2020/0/AssisTV#bollino_rosso") {row.append($("<td>" + "<img src='Bollino_rosso_TV.png'width='40' height='40'> "));}
                            if(b.b.value == "http://www.semanticweb.org/teo/ontologies/2020/0/AssisTV#bollino_giallo") {row.append($("<td>" + "<img src='Bollino_giallo_TV.png'width='40' height='40'> "));}
                            if(b.b.value == "http://www.semanticweb.org/teo/ontologies/2020/0/AssisTV#bollino_verde") {row.append($("<td>" + "<img src='bollino_verde_TV.png'width='40' height='40'> "));}
                            row.append($("<td>", {text: b.o.value+":"+b.m.value}));
                            row.append($("<td>", {text: b.dr.value}));
                            row.append($("<td>", {text: b.c.value.slice(b.c.value.search("#") +1)}));
                          }
                          });

                        }
                        //giovedi
                        if(dati.head.vars){
                          var i = 0
                          //alert("g"); ok
                          $.each(dati.results.bindings, function(index, b){

                          if(b.g.value.slice(b.g.value.search("#") +1)=="giovedi")
                          {
                            if(i==0){var row = $("<tr>").appendTo(table); '<br>'
                            row.append($("<td>", {text: b.g.value.slice(b.g.value.search("#") +1)})); i++;}

                            console.log(index);
                            console.log(b);

                            var row = $("<tr>").appendTo(table);
                            row.append($("<td>"));
                            row.append($("<td>", {text: b.p.value.slice(b.p.value.search("#") +1)}));
                            row.append($("<td>", {text: b.d.value}));
                            if(b.b.value == "http://www.semanticweb.org/teo/ontologies/2020/0/AssisTV#bollino_rosso") {row.append($("<td>" + "<img src='Bollino_rosso_TV.png'width='40' height='40'> "));}
                            if(b.b.value == "http://www.semanticweb.org/teo/ontologies/2020/0/AssisTV#bollino_giallo") {row.append($("<td>" + "<img src='Bollino_giallo_TV.png'width='40' height='40'> "));}
                            if(b.b.value == "http://www.semanticweb.org/teo/ontologies/2020/0/AssisTV#bollino_verde") {row.append($("<td>" + "<img src='bollino_verde_TV.png'width='40' height='40'> "));}
                            row.append($("<td>", {text: b.o.value+":"+b.m.value}));
                            row.append($("<td>", {text: b.dr.value}));
                            row.append($("<td>", {text: b.c.value.slice(b.c.value.search("#") +1)}));
                          }
                          });

                        }
                        //venerdi
                        if(dati.head.vars){
                          var i = 0
                          //alert("g"); ok
                          $.each(dati.results.bindings, function(index, b){

                          if(b.g.value.slice(b.g.value.search("#") +1)=="venerdi")
                          {
                            if(i==0){var row = $("<tr>").appendTo(table); '<br>'
                            row.append($("<td>", {text: b.g.value.slice(b.g.value.search("#") +1)})); i++;}

                            console.log(index);
                            console.log(b);

                            var row = $("<tr>").appendTo(table);
                            row.append($("<td>"));
                            row.append($("<td>", {text: b.p.value.slice(b.p.value.search("#") +1)}));
                            row.append($("<td>", {text: b.d.value}));
                            if(b.b.value == "http://www.semanticweb.org/teo/ontologies/2020/0/AssisTV#bollino_rosso") {row.append($("<td>" + "<img src='Bollino_rosso_TV.png'width='40' height='40'> "));}
                            if(b.b.value == "http://www.semanticweb.org/teo/ontologies/2020/0/AssisTV#bollino_giallo") {row.append($("<td>" + "<img src='Bollino_giallo_TV.png'width='40' height='40'> "));}
                            if(b.b.value == "http://www.semanticweb.org/teo/ontologies/2020/0/AssisTV#bollino_verde") {row.append($("<td>" + "<img src='bollino_verde_TV.png'width='40' height='40'> "));}
                            row.append($("<td>", {text: b.o.value+":"+b.m.value}));
                            row.append($("<td>", {text: b.dr.value}));
                            row.append($("<td>", {text: b.c.value.slice(b.c.value.search("#") +1)}));
                          }
                          });

                        }
                        //sabato
                        if(dati.head.vars){
                          var i = 0
                          //alert("g"); ok
                          $.each(dati.results.bindings, function(index, b){

                          if(b.g.value.slice(b.g.value.search("#") +1)=="sabato")
                          {
                            if(i==0){var row = $("<tr>").appendTo(table); '<br>'
                            row.append($("<td>", {text: b.g.value.slice(b.g.value.search("#") +1)})); i++;}

                            console.log(index);
                            console.log(b);

                            var row = $("<tr>").appendTo(table);
                            row.append($("<td>"));
                            row.append($("<td>", {text: b.p.value.slice(b.p.value.search("#") +1)}));
                            row.append($("<td>", {text: b.d.value}));
                            if(b.b.value == "http://www.semanticweb.org/teo/ontologies/2020/0/AssisTV#bollino_rosso") {row.append($("<td>" + "<img src='Bollino_rosso_TV.png'width='40' height='40'> "));}
                            if(b.b.value == "http://www.semanticweb.org/teo/ontologies/2020/0/AssisTV#bollino_giallo") {row.append($("<td>" + "<img src='Bollino_giallo_TV.png'width='40' height='40'> "));}
                            if(b.b.value == "http://www.semanticweb.org/teo/ontologies/2020/0/AssisTV#bollino_verde") {row.append($("<td>" + "<img src='bollino_verde_TV.png'width='40' height='40'> "));}
                            row.append($("<td>", {text: b.o.value+":"+b.m.value}));
                            row.append($("<td>", {text: b.dr.value}));
                            row.append($("<td>", {text: b.c.value.slice(b.c.value.search("#") +1)}));
                          }
                          });

                        }
                        //domenica
                        if(dati.head.vars){
                          var i = 0
                          //alert("g"); ok
                          $.each(dati.results.bindings, function(index, b){

                          if(b.g.value.slice(b.g.value.search("#") +1)=="domenica")
                          {
                            if(i==0){var row = $("<tr>").appendTo(table); '<br>'
                            row.append($("<td>", {text: b.g.value.slice(b.g.value.search("#") +1)})); i++;}

                            console.log(index);
                            console.log(b);

                            var row = $("<tr>").appendTo(table);
                            row.append($("<td>"));
                            row.append($("<td>", {text: b.p.value.slice(b.p.value.search("#") +1)}));
                            row.append($("<td>", {text: b.d.value}));
                            if(b.b.value == "http://www.semanticweb.org/teo/ontologies/2020/0/AssisTV#bollino_rosso") {row.append($("<td>" + "<img src='Bollino_rosso_TV.png'width='40' height='40'> "));}
                            if(b.b.value == "http://www.semanticweb.org/teo/ontologies/2020/0/AssisTV#bollino_giallo") {row.append($("<td>" + "<img src='Bollino_giallo_TV.png'width='40' height='40'> "));}
                            if(b.b.value == "http://www.semanticweb.org/teo/ontologies/2020/0/AssisTV#bollino_verde") {row.append($("<td>" + "<img src='bollino_verde_TV.png'width='40' height='40'> "));}
                            row.append($("<td>", {text: b.o.value+":"+b.m.value}));
                            row.append($("<td>", {text: b.dr.value}));
                            row.append($("<td>", {text: b.c.value.slice(b.c.value.search("#") +1)}));
                          }
                          });

                        }



                      },
                      error: function (xhr){
                        alert ("Errore nell'estrazione dei dati: " + xhr.status + " " + xhr.statusText);
                      }
                    });
                  });

                </script>


            </body>
            </html>
